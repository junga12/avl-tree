# avl-tree

이진 트리는 한쪽으로 치우칠 수 있는 단점이 있습니다. 이런 단점을 보완하는 트리가 AVL 트리로, 왼쪽 서브트리와 오른쪽 서브트리의 높이는 항상 0 이거나 1인 트리입니다.

항상 오른쪽과 왼쪽의 균형을 맞추기 때문에 최악의 경우에도 `O(logN)`의 연산이 가능하다는 장점이 있습니다. (이진탐색트리의 경우에는 최악의 경우 `O(N)`의 연산이 소요된다.) 하지만 삽입, 삭제를 할 때마다 균형을 유지하기 위한 연산을 해야하므로 더 많은 연산을 수행해야 한다는 한계점이 있습니다. 



### 삽입

avl트리의 데이터 삽입은 이진탐색트리와 동일하게 진행됩니다. 노드를 방문하며 삽입하려는 데이터가 해당 노드의 데이터보다 작으면 왼쪽 서브트리로 이동하고, 크면  오른쪽 서브트리로 이동하여 비어있는 위치에 데이터를 삽입합니다. 

새로 삽입된 위치부터 루트노드까지 올라가며 각 노드의 높이를 갱신하고, 만약 불균형한 노드라면 회전 연산을 수행합니다.



### 삭제

삭제할 데이터의 노드가

- 리프노드인 경우
  - 그냥 삭제한다.
- 하나의 자식을 가지고 있는 경우
  - 삭제하려는 데이터가 있는 노드가 자식 노드를 참조하게 만든다.
- 두 개의 자식을 가지고 있는 경우
  - 왼쪽 서브트리 중 가능 큰 데이터나 오른쪽 서브트리 중 가장 작은 데이터의 노드를 선택한다.
  - 선택된 노드와 삭제하려는 노드의 위치를 변경한다.

삭제 후 불균형한 노드가 존재하면 균형있게 회전 연산을 수행합니다.



### 탐색

이진 탐색 트리와 탐색과 동일하게 진행합니다.

루트 노드부터 시작하여 탐색하려는 데이터가 노드 데이터보다 작으면 왼쪽으로, 크면 오른쪽으로 이동합니다.



#### 불균형한 노드인지 판단하는 방법

앞에서 avl 트리는 항상 왼쪽 서브트리와 오른쪽 서브트리의 차이가 0이거나 1이라고 말했습니다. 

따라서 왼쪽 서브트리와 오른쪽 서브트리의 차이가 2이상인 경우에는 불균형한 노드라고 판단합니다. 

또한 서브트리가 존재하지 않는 경우에는 -1의 높이를 가지고 있게 만들어 주어야 합니다. 



#### 회전 연산

회전 연산은 불균형한 경우에 진행하는 연산으로 트리의 균형을 유지하기 위해서 수행됩니다.

회전은 크게 오른쪽 방향으로 회전하는 연산과 왼쪽 방향으로 회전하는 연산이 존재합니다. 



##### Right Rotation (RR)

그림과 같이 왼쪽으로 치우친 경우입니다.

```
    7
   /
  5
 /
3
```

7의 값을 가진 노드는 왼쪽 서브트리의 높이가 1, 오른쪽 서브트리는 null이므로 -1입니다. 두 서브트리의 차가 `1 - (-1) = 2`이므로 오른쪽 회전 연산을 수행합니다.

```
  5
 /  \
3    7
```



##### Left Rotation (LL)

오른쪽으로 치우쳐진 경우입니다.

```
3
  \
   5
    \
     7
```

3의 값을 가진 노드는 왼쪽 서브트리의 높이가 -1, 오른쪽 서브트리의 높이가 1입니다. `-1 - 1 = -2`로 왼쪽으로 회전 연산을 수행합니다.

```
  5
 /  \
3    7
```



##### Left Right Double Rotation (LR)

노드가 오른쪽 자식만 가지고 있지만, 자식 노드는 왼쪽 자식만 가지고 있는 경우입니다.

```
3
  \
   7
  /
 5
```

7의 값을 가진 노드에서 오른쪽 회전을 수행한 후, 3의 값을 가진 노드에서 왼쪽 회전 연산을 수행합니다.



##### Right Left Double Rotation (RL)

노드가 왼쪽 자식만 가지고 있고, 자식 노드는 오른쪽 자식만 가지고 있는 경우입니다.

```
   7
 /
3
 \
  5
```

3의 값을 가진 노드에서 왼쪽 회전을 수행한 후, 5의 값을 가진 노드에서 오른쪽 연산을 수행합니다.



---

참조

https://www.codingeek.com/data-structure/avl-tree-introduction-to-rotations-and-its-implementation/
https://m.blog.naver.com/PostView.nhn?blogId=beaqon&logNo=221298914412&proxyReferer=https:%2F%2Fwww.google.com%2F
https://doublesprogramming.tistory.com/237